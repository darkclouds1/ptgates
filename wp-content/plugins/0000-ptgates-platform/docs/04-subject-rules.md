# ptGates 문항(Study/Quiz) 선택 및 순서 로직 요구사항

> **중요**: 이 문서는 Study, Quiz, 학습하기, 모의고사 모두에 공통 적용되어야 하는 요구사항입니다.

## 1. 문항 선택 로직 (로그인 상태에 따라 다름)

### 비회원 (로그아웃)
- **조건**: 별도 조건 없음
- **로직**: 현재 로직대로 **조건 없이** 문항 제공

### 로그인 회원 (자동 선택)
- **조건**: 학습 균형 목적
- **로직**: `ptgates_user_states` 테이블의 `study_count` 및 `quiz_count` 값이 **낮은 순서** 위주로 선택
- **목적**: 학습 횟수가 적은 문항을 우선적으로 제시하여 균형 잡힌 학습 유도

### 로그인 회원 (직접 선택)
- **조건**: 특정 주제 집중
- **로직**: **세부 과목을 직접 선택**하면, 해당 세부 과목 내 문항들만 선택됨
- **목적**: 사용자가 원하는 특정 세부 과목에 집중하여 학습

## 2. 문항 순서 로직 (모든 문항은 랜덤)

### 세부 과목 내 문항 배열
- **규칙**: 모든 경우(자동 선택, 직접 선택)에 선택된 세부 과목 내의 문항들은 **랜덤하게 섞여서** 나와야 합니다.
- **목적**: 순서에 의한 학습 패턴 형성 방지, 학습 효과 향상

## 3. 과목 및 세부 과목 순서 유지 (Map 순서 반드시 준수)

### 중요 사항
- 과목 또는 교시를 선택했을 때 사용자에게 제시되는 순서는 `class-subjects.php` 파일의 `MAP` 상수에 정의된 순서를 **반드시 지켜야** 합니다.
- **절대 랜덤하지 않음**: 교시/과목 레벨에서의 순서는 MAP 정의 순서 그대로 유지

### 가장 상위 순서 유지 (교시/과목)

#### 교시를 선택하는 경우
- **예시**: 1교시를 선택
- **규칙**: **1교시의 과목 순서**는 MAP 순서를 따라야 합니다.
- **MAP 예시**: 
  ```
  1교시 => [
    '물리치료 기초',      // 첫 번째 과목
    '물리치료 진단평가'    // 두 번째 과목
  ]
  ```
- **UI 표시 순서**: 항상 "물리치료 기초" → "물리치료 진단평가" 순서로 표시

#### 과목을 선택하는 경우
- **예시**: "물리치료 기초" 과목을 선택
- **규칙**: 해당 **과목의 세부 과목 순서**는 MAP 순서를 지켜야 합니다.
- **MAP 예시**:
  ```
  '물리치료 기초' => [
    '해부생리',          // 첫 번째 세부 과목
    '운동학',            // 두 번째 세부 과목
    '물리적 인자치료',    // 세 번째 세부 과목
    '공중보건'           // 네 번째 세부 과목
  ]
  ```
- **UI 표시 순서**: 항상 "해부생리" → "운동학" → "물리적 인자치료" → "공중보건" 순서로 표시

### 하위 순서 유지 (세부 과목)

#### 세부 과목 선택 시
- **예시**: "해부생리" 세부 과목을 선택
- **규칙**: 해당 **세부 과목 내 문항들**은 랜덤하게 섞여서 나와야 합니다.
- **주의**: 세부 과목 간 순서는 MAP 순서를 지키지만, 세부 과목 내 문항 순서는 랜덤입니다.

---

## 요약

### 문항 선택 로직
| 로그인 상태 | 조건 | 로직 |
| :--- | :--- | :--- |
| 비회원 | 별도 조건 없음 | 조건 없이 문항 제공 |
| 로그인 회원 (자동) | 학습 균형 목적 | `study_count`/`quiz_count` 낮은 순서 위주 |
| 로그인 회원 (직접 선택) | 특정 주제 집중 | 선택한 세부 과목 내 문항들만 |

### 문항 순서 로직
| 레벨 | 순서 규칙 |
| :--- | :--- |
| 교시/과목 | MAP 순서 유지 (랜덤 아님) |
| 세부 과목 | MAP 순서 유지 (랜덤 아님) |
| 세부 과목 내 문항 | 랜덤 (MAP 순서 아님) |

### 적용 범위
- ✅ Study 모드
- ✅ Quiz 모드
- ✅ 학습하기
- ✅ 모의고사

---

**최종 업데이트:** 2025-01-XX  
**버전:** 1.0.0  
**참조**: `0000-ptgates-platform/includes/class-subjects.php`의 MAP 상수
